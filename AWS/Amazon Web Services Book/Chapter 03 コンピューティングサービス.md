
##### 代表的なサーバーの種類
- Webサーバー
  HTMLファイルやCSSファイル、アセットなどサービス提供に必要なデータが保存されている。Webサイトの構成に必要になるデータの保存と、システムの制御を行うプログラム群を導入したサーバー。

- DBサーバー
  システムが取り扱うデータを一元管理。AWSではRDSやDynamoDBなどデータベースに特化したサービスが提供されている。

- メールサーバー
  SMTPプロトコル、POP3プロトコルを利用してメール操作を行うサーバーのこと。
  AWSではEC2で自らメールサーバーを作成することも可能で、AWSマネージドのメール送信サービスAmazon SESを利用することもできる。

##### Webサーバーの仕組み
![[スクリーンショット 2025-01-15 15.45.30.png]]

##### サーバーのOS
サーバーにも必ずOSが搭載されており、主にLinuxやWindows Serverが利用される。

- Linux
  無料化かつOSSであるため、誰でも自由に開発・配布できる。
  大元のLinuxカーネルと呼ばれるソフトウェアを基本とし、様々な企業や団体が独自に開発を加えたOSをLinuxディストリビューションとして提供されている。
  
  ![[スクリーンショット 2025-01-15 15.49.04.png]]
  
- Windows Server
  マイクロソフトからリリースされているサーバー用OS。利用にはOS自体のライセンスやCAL(Client Access License)と呼ばれるサーバー利用ライセンスが必要。
  Windows ServerはGUI操作であり、CUI操作となるLinuxディストリビューションと比べて利用しやすく、Active Directoryとの連携もある。
  
  
  ![[スクリーンショット 2025-01-15 15.51.55.png]]

##### サーバーの仮想化
1つのハードウェア上に複数のOSを稼働させて、仮想サーバーの大きさに応じてCPUやメモリなどのリソースの振り分けを行う。

- AWSにおける仮想化
  AWSで最も代表的なものはAmazon Elastic Compute Cloud (Amazon EC2)。
  AWSの大規模なサーバーでこの仮想化が行われて、ユーザーは自分の用途に応じてOSの種類やリソースを選択、インスタンス(仮想サーバー)を作成する。


##### Amazon EC2は仮想サーバーサービス
EC2は仮想サーバーを数分で作成できる。LinuxやWindowsなど、OSはAWSが用意しているものから選択できる。
![[スクリーンショット 2025-01-15 15.57.42.png]]

EC2では、仮想サーバーをインスタンスという単位で管理して、ユーザーはインスタンスタイプ(=仮想サーバーのスペック)を決定して利用する。

- 仮想サーバの作成
  EC2のインスタンスは、次の設定値を選択すれば最低限作成可能
  - Amazon マシンイメージ(AMI)
  - インスタンススペック
  - 配置するネットワーク
  - データを保存するストレージの容量(EBS)
  - アクセス許可設定(セキュリティグループ)

インスタンスの作成後は、LinuxであればSSH、Windowsであればリモートデスクトップなど、管理系の機能を使用して接続できる。AWS Systems ManagerというEC2を管理できるサービスもあり、それを利用してサーバーに接続もできる。
![[スクリーンショット 2025-01-15 16.08.36.png]]

インスタンスタイプのネーミングは次図のように決まる
![[スクリーンショット 2025-01-15 16.09.36.png]]

EC2インスタンスのファミリー
T系インスタンスについてはベースライン(CPU使用率)が定義されていて、それを超えて利用可能。ただし、それを超える場合、ベースライン以下の性能になるか、追加料金が発生するため、本番環境など常時仕様が見込まれる環境ではM系のインスタンスを選択する。
![[スクリーンショット 2025-01-15 16.12.19.png]]


##### 仮想サーバーを安全に外部に公開

###### サーバの外部公開
EC2をインターネットに公開するためには以下の３つの条件を満たす必要がある。
- EC2をパブリックサブネットに配置
- パブリックIPアドレスをEC2に付与
- セキュリティグループで外部からのアクセスを許可
![[スクリーンショット 2025-01-16 10.40.40.png]]

###### サーバーへのアクセス制御
EC2のアクセス制御にはセキュリティグループを使用する。オンプレミスではファイアウォールを利用していたが、セキュリティグループは仮想ファイアウォール機能。
セキュリティグループで設定できるルールは許可のみ、特定のネットワークからの通信を拒否する設定はできない。

インバウンドルール：EC2への通信
アウトバウンドリール：EC2から外部への通信

![[スクリーンショット 2025-01-16 10.40.49.png]]

##### 負荷に応じてサーバーを自動的に追加・削除する
Amazon EC2 Auto Scalingを使用するとサーバーの複製追加と削除を負荷状況（CPU使用率など）に応じて自動実行できる。

スケールアウト：サーバーを追加すること
スケールイン　：サーバーを削除すること
![[スクリーンショット 2025-01-16 10.58.12.png]]

ターゲット追跡スケーリング：指定した値に近づくようサーバー数を自動設定する機能
スケジュールスケーリング　：システムの利用時間に合わせてサーバー数を設定する機能


##### サーバーを持たずにプログラムを実行する
###### Lambdaはサーバーレスコンピューティングサービス
利用者はプログラムコードを準備してLambdaにアップロードするだけで実行できる。
AWS側で実行基盤が管理されるため、インフラ部分の管理をAWS側に任せられるため、ビジネスロジックに関わるコード開発に集中できる。
![[スクリーンショット 2025-01-16 11.03.22.png]]

##### サーバーレスの活用方法をもっと理解する
###### AWS Lambdaは他のサービスと組み合わせて使用する
何かをきっかけに自動的にLambda関数を実行する場合は、他のAWSサービスと連携する必要がある。

- ユーザのリクエストに応じてLambda関数を実行する
  AMazon API Gatewayを組み合わせることで、HTTPリクエストをトリガーとして関数を実行できる。
  ![[スクリーンショット 2025-01-16 11.05.55.png]]

- S3へのデータ格納時に自動処理を行う
  Amazon S3パケットにデータが格納されたら、格納されたデータに対してLambdaで自動処理を行うこともできる。
  ![[スクリーンショット 2025-01-16 11.07.06.png]]

- 定期的にLambda関数を実行する
  Amazon EventBridgeを組み合わせることで、決まった時間に処理を実行できる。
  ![[スクリーンショット 2025-01-16 11.08.09.png]]

Lambdaの実行環境はAWS側で管理されるが、下記のパラメータはユーザが設定する
- メモリ容量
- タイムアウト時間
- 環境変数
LambdaはS3に対してデータ格納したり、EC2の起動・停止をしたり、他のAWSリソースを操作する目的で利用されるが、最初からそれらに対する操作権限を持っているわけではない。
Lambda関数にIAMロールという形式で権限を付与して設定する。
  ![[スクリーンショット 2025-01-16 11.10.40.png]]
##### コンテナの仕組みと特徴を理解する
###### コンテナとは
![[スクリーンショット 2025-01-16 11.56.24.png]]

コンテナは仮想サーバーよりも軽量で起動が早いのが特徴。
OSとミドルウェアの起動がない点や、OSへのオーバーヘッドがない分、仮想サーバーよりも高速となる。
![[スクリーンショット 2025-01-16 12.01.08.png]]

###### コンテナはデリバリーしやすい
システム環境へ反映しやすいため、デリバリーに優れている。
コンテナイメージを作成しておくと、そのサーバー環境においてもコンテナランタイムさえインストールしておけばコンテナイメージで定義したアプリケーションプロセスを実行できる。
ローカルのPCで起草していたコンテナをそのまま本番環境に同じように起動できるため、再現性が高くなり、複数のシステム環境で動かす場合でも環境による差異を少なくできる。

レジストリ：イメージ管理ツール
イメージごとにレポジトリという単位で管理できるので、複数のシステム環境に対して容易に展開することが可能。

ただし、コンテナなランタイムはサーバー側のOS上で起動するので、同じサーバー上で起動するコンテナは異なるOSを利用することができない。
またコンテナは揮発性を持ち、コンテナが削除されるとコンテナ内に保存されているデータも一緒に削除されてしまう。
よって、OSに依存したり、処理するデータを保持しなければならない設計になっているアプリケーションは、コンテナ利用に不向き。

###### コンテナオーケストレーション
多くの場合、さまざまなプロセスを複数のコンテナで稼働させることになる。
この際に使われるのがコンテナオーケストレーションツールで、運用負荷を軽減することができる。
![[スクリーンショット 2025-01-16 13.17.25.png]]

##### ECSでコンテナのメリットを受領する
###### AWSのコンテナオーケストレーションサービス
Amazon Elastic Container Service(ECS)とAmazon Kubernetes Service(EKS)という選択肢がある。

- ECS
  オーケストレーションの機能をAWSが担う

- EKS
  オーケストレーションの機能をKubernetesが担う

- ECR(Elastic Container Registry)
  マネージドなコンテナイメージレジストリサービス、カスタマイズしたコンテナイメージをAWS上で管理することができ、ECSへの展開も容易になる

###### EC2とFargate
ECSを利用してコンテナを起動する場合、EC2とAWS Fargateのプラットフォームから起動するか選択可能。

- EC2の場合：
  EC2インスタンス内で起動するコンテナランタイム上でコンテナを起動する。
  コンテナランタイムがインストールされているサーバー（EC2インスタンス）の管理をユーザー側で行う

- Fargateの場合：
  AWS側が管理するサーバー上でコンテナを起動する。
  コンテナランタイム・OSも含めて管理をAWS側に任せられるため、ユーザーは管理を意識しなくていい。
  ![[スクリーンショット 2025-01-16 13.37.23.png]]
###### Fargateのメリット

  ![[スクリーンショット 2025-01-16 13.39.47.png]]

##### サーバー知識なしで使える代表的なサービス5選

- AWS Lightsail
  一般的に利用される構成の仮想サーバーを簡単にすばやく構築するためのサービス。
  複数のインスタンスを作成すると自動的にアクセスが負荷分散されるようになったり、SSL/TLS証明書による通信の暗号化にも対応している。
  また、DBやコンテナ環境の作成にも対応していて、VPCを通じて他のうAWSサービスと連携できる。

- AWS Elastic Beanstalk
  主要な言語、環境で開発されたアプリケーションをデプロイするための環境一式を自動的に作成するサービス。コードをアップロードするだけで、EC2やRDS、S3といったAWSリソースが自動的に構築されてデプロイされる。

- AWS App Runner
  コンテナ化されたアプリケーションを簡単にデプロイするサービス。
  コンテナイメージを指定して、サービスポートやAuto Scalingなどいくつかの設定を行うだけでコンテナをFargateへデプロイできる。

- AWS Batch
  指定したプログラムをEC2やGargateで動作させるサービス。
  プログラムの順序管理や、多数のプログラムの並列稼働といった複雑な制御に特化している。

- AWS Outposts
  AWSが物理サーバーを貸し出すサービスで、利用者がオンプレミス環境でAWSと同じサービスを動かすことができるようになる。つまりAWSをプライベートクラウド化して提供できる。

  



